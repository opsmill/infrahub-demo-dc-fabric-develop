---
version: "1.0"
infrahub_tests:
  # --------------------  Checks  --------------------
  - resource: Check
    resource_name: "Topology check"
    tests:
      - name: syntax_check
        spec:
          kind: check-smoke
  # --------------------  GraphQLQuery  --------------------
  - resource: GraphQLQuery
    resource_name: device_info
    tests:
      - name: syntax_check
        spec:
          path: templates/device_info.gql
          kind: graphql-query-smoke

  - resource: GraphQLQuery
    resource_name: oc_interfaces
    tests:
      - name: syntax_check
        spec:
          path: transforms/oc_interfaces.gql
          kind: graphql-query-smoke
  # --------------------  Jinja2Transform  --------------------
  - resource: Jinja2Transform
    resource_name: device_arista
    tests:
      - name: syntax_check
        spec:
          kind: jinja2-transform-smoke

      - name: baseline
        expect: PASS
        spec:
          kind: "jinja2-transform-unit-render"
          directory: device_arista/baseline

      - name: missing_interfaces
        expect: FAIL
        spec:
          kind: "jinja2-transform-unit-render"
          directory: device_arista/missing_interfaces

  # --------------------  PythonTransform  --------------------
  - resource: PythonTransform
    resource_name: OCInterfaces
    tests:
      - name: baseline
        expect: PASS
        spec:
          kind: python-transform-unit-process
          directory: oc_interfaces/baseline
